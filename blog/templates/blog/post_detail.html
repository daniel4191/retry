{% extends "blog/base.html" %} {% block head_title %} {{ post.title }} - Blog
{%endblock %} {% block main_area %}

<div class="post-area">
    <!-- category -->
    {% if post.category %}
    <span class="badge badge-secondary float-right">{{ post.category }}</span>
    {% else %}
    <span class="badge badge-secondary float-right">미분류</span>
    {% endif %}

    <!-- Post header-->
    <header class="mb-4">
        <!-- Post title-->
        <h1 class="mt-4">{{ post.title }}</h1>
        <h5 class="text-muted">{{ post.hook_text }}</h5>

        <!-- Author -->
        <p class="lead">by <a href="#">{{ post.author | upper }}</a></p>

        <!-- Edit post -->
        {% if user.is_authenticated and user == post.author %}
        <a
            href="/blog/update_post/{{ post.pk }}/"
            role="button"
            class="btn btn-info btn-sm float-right m-2"
            ><i class="fa-solid fa-pencil"></i> Edit Post</a
        >
        {% endif %}

        <!-- Post date -->
        <p>{{ post.created }}</p>
        <hr />
    </header>

    <!-- Preview image figure-->
    <!-- if image in files come for entry picture  -->
    {% if post.head_image %}
    <figure class="mb-4">
        <img
            class="img-fluid rounded"
            src="{{ post.head_image.url }}"
            alt="{{ post.title }} head image"
        />

        <!-- if none image in files, bring come from lorem picture  -->
        {% else %}
        <img
            class="card-img-top"
            src="https://picsum.photos/seed/{{ post.pk }}/800/200"
            alt="random_image"
        />
        {% endif %}
    </figure>

    <!-- Post content-->
    <p>{{ post.get_content_markdown | safe }}</p> <!-- get_content_markdown | safe로 content필드에 마크다운에 따라 저장된 텍스트를 html로 변환후 리턴 -->

    <!-- tags 추가 -->
    {% if post.tags.exists %}
    <i class="fa-solid fa-tags"></i>
    {% for tag in post.tags.all %}
    <a href="{{ tag.get_absolute_url }}"
        ><span class="badge badge-pill badge-light">{{ tag }}</span></a
    >
    {% endfor %}
    <br />
    <br />
    {% endif %}
    <!-- tags end -->

    {% if post.file_upload %}
    <a
        href="{{ post.file_upload.url }}"
        class="btn btn-outline-success m-1"
        role="button"
        download
        >Download: {% if post.get_file_ext == "csv" %}
        <i class="fa-solid fa-file-csv"></i>
        {% elif post.get_file_ext == "xlsx" or post.get_file_ext == "xls" %}
        <i class="fa-solid fa-file-excel"></i>
        {% elif post.get_file_ext == "docx" or post.get_file_ext == "doc" %}
        <i class="fa-solid fa-file-word"></i>
        {% else %}
        <i class="fa-solid fa-file"></i>
        {% endif %}
    </a>
    {% endif %}
</div>

<div class="comment-area">
    <!-- Comments section-->
    <div class="card my-4">
        <h5 class="card-header">Leave a Comment:</h5>
        <div class="card-body">
            <form>
                <div class="form-group">
                    <textarea class="form-control" rows="3"></textarea>
                </div>
                <button type="submit" class="btn btn-primary">Submit</button>
            </form>
        </div>
    </div>

    {% if post.comment_set.exists %}

        {% for comment in post.comment_set.iterator %}
        <!-- single comment -->
        <div class="media mb-4" id="comment-{{ comment.pk }}">
            <img class="d-flex mr-3 rounded-circle" src="http://placehold.it/50x50" alt="">
            <div class="media-body">
                <h5 class="mt-0">{{ comment.author.username }} &nbsp;&nbsp;<small class="text-muted">{{ comment.created_at }}</small>
                </h5>
                <p>{{ comment.content | linebreaks }}</p>
            </div>
        </div>
        {% endfor %}
    {% endif %}
</div>
<hr>

{% endblock %}
